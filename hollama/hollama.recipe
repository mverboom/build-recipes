[INFO]
arch=amd64

[VERSION]
B_GITVER https://github.com/fmaclen/hollama/

[REQUIRED]
nodejs-B_PF

[BUILD]
B_GET git https://github.com/fmaclen/hollama/ hollama
cd hollama
git checkout $B_VERSION
#sed -i 's/"vite build"/"vite build --base=\/hollama\/"/' package.json
sed -i 's/.*"version": .*"/     "version": "'$B_VERSION'"/' package.json
npm ci
npm run build
echo "cache=/tmp/.npm" >> .npmrc

rm -rf Dockerfile LICENSE *.md .git .github .gitignore test .vscode .npmignore docker images npm-shrinkwrap.json .dockerignore .eslintignore .eslintrc.cjs electron electron-builder.yml tests src
mkdir -p "$B_INSTALLDIR/opt/hollama"
tar cfB - . | (cd $B_INSTALLDIR/opt/hollama ; tar xfB - )

[PKG]
type=deb
torepo=y

[DEB]
Package: hollama
Version: B_VERSION
Section: hollama
Priority: optional
Architecture: B_ARCH
Maintainer: B_MAIL
Description: Hollama custom B_ORG build
Homepage: https://github.com/fmaclen/hollama
Depends: nodejs-lts-B_PF
