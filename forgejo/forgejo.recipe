[INFO]
arch=amd64

[VERSION]
B_GITVER -e "dev" https://codeberg.org/forgejo/forgejo

[REQUIRED]
nodejs-lts-B_PF golang-B_PF gcc make

[BUILD]
B_GET git https://codeberg.org/forgejo/forgejo forgejo
cd forgejo
git checkout v${B_VERSION}
make frontend
TAGS="bindata timetzdata sqlite sqlite_unlock_notify" make build
rm -rf .[^.] .??* node_modules web_src Makefile main.go public
mkdir -p $B_INSTALLDIR/etc/forgejo
cp custom/conf/app.example.ini $B_INSTALLDIR/etc/forgejo/
mkdir -p $B_INSTALLDIR/opt/forgejo
tar cfB - templates gitea | ( cd $B_INSTALLDIR/opt/forgejo ; tar xfB - )

[PKG]
type=deb
torepo=y

[DEB]
Package: forgejo
Version: B_VERSION
Section: forgejo
Priority: optional
Architecture: B_ARCH
Maintainer: B_MAIL
Description: forgejo custom B_ORG build
Homepage: https://codeberg.org/forgejo/forgejo
Depends: git
